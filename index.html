<!doctype html>
<html lang="ja">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link href="./css/main.css" rel="stylesheet">

    <title>パスワードジェネレーター｜もじゃテック</title>
  </head>
  <body>
    <nav class="navbar navbar-dark bg-primary">
      <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">パスワードジェネレーター</span>
      </div>
    </nav>

    <div class="container">
      <div class="row">
        <div class="col-6">
          <div class="form mt-3">

            <div class="row">
              <div class="col-2 mt-4">文字列</div>
              <div class="col-10 mt-4">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="uppercase" id="uppercase" checked>
                  <label class="form-check-label" for="uppercase">A ~ Z を含む</label>
                </div>
                <div class="form-check mt-2">
                  <input class="form-check-input" type="checkbox" value="lowercase" id="lowercase" checked>
                  <label class="form-check-label" for="lowercase">a ~ z を含む</label>
                </div>
                <div class="form-check mt-2">
                  <input class="form-check-input" type="checkbox" value="num" id="num" checked>
                  <label class="form-check-label" for="num">0 ~ 9 を含む</label>
                </div>
                <div class="form-check mt-2">
                  <input class="form-check-input" type="checkbox" value="hyphen" id="hyphen">
                  <label class="form-check-label" for="hyphen">ハイフン(-) を含む</label>
                </div>
                <div class="form-check mt-2">
                  <input class="form-check-input" type="checkbox" value="underscore" id="underscore">
                  <label class="form-check-label" for="underscore">アンダーバー(_) を含む</label>
                </div>
                <div class="form-check mt-2">
                  <input class="form-check-input" type="checkbox" value="symbol" id="symbol">
                  <label class="form-check-label" for="symbol">記号（/*+.,!#$%&()~|@）を含む</label>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-2">文字数</div>
              <div class="col-10">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="word" id="word_8" value="8" checked>
                  <label class="form-check-label" for="word_8">８文字</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="word" id="word_12" value="12">
                  <label class="form-check-label" for="word_12">１２文字</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="word" id="word_16" value="16">
                  <label class="form-check-label" for="word_16">１６文字</label>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-2">個数</div>
              <div class="col-10">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="qty" id="qty_5" value="5" checked>
                  <label class="form-check-label" for="qty_5">５個　</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="qty" id="qty_10" value="10">
                  <label class="form-check-label" for="qty_10">１０個　</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="qty" id="qty_15" value="15">
                  <label class="form-check-label" for="qty_15">１５個</label>
                </div>
              </div>
            </div>

            <div class="row mt-5 text-center">
              <div class="col-4">
                <button type="button" class="btn btn-outline-secondary w-75" id="reset_btn">リセット</button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-outline-primary w-75" id="create_btn">作成</button>
              </div>
            </div>

          </div>
        </div>
        <div class="col-6">
          <div id="res" class="box pt-4">
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
              <div class="col-6">
                <p class="heading tag rounded hide"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <script>
      function reset(){
        // 大文字
        const uppercase = document.getElementById("uppercase");
        uppercase.checked = true ;
        // 小文字
        const lowercase = document.getElementById("lowercase");
        lowercase.checked = true ;
        // 数値
        const num = document.getElementById("num");
        num.checked = true ;
        // ハイフン
        const hyphen = document.getElementById("hyphen");
        hyphen.checked = false ;
        // アンダーバー
        const underscore = document.getElementById("underscore");
        underscore.checked = false ;
        // 記号
        const symbol = document.getElementById("symbol");
        symbol.checked = false ;
        // 文字数
        const word = document.getElementsByName("word");
        word[0].checked = true ;
        // 個数
        const qty = document.getElementsByName("qty");
        qty[0].checked = true ;

        let tags = document.getElementsByClassName("heading tag rounded");
        for(let i = 0; i < tags.length ; i ++ ) {
          if(!tags[i].classList.contains("hide")){
            tags[i].classList.add("hide");
          }
        }
      }

      function create(){
        let strings = "";
        let array = [];
        if(document.getElementById("uppercase").checked){
          strings += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        }
        if(document.getElementById("lowercase").checked){
          strings += "abcdefghijklmnopqrstuvwxyz";
        }
        if(document.getElementById("num").checked){
          strings += "0123456789";
        }
        if(document.getElementById("hyphen").checked){
          strings += "-";
        }
        if(document.getElementById("underscore").checked){
          strings += "_";
        }
        if(document.getElementById("symbol").checked){
          strings += "/*+.,!#$%&()~|@";
        }
        array = strings.split('');
        shuffled_array = fisherYatesShuffle(array);
        const res = resultPasswords(shuffled_array);
        resultDisplay(res);
      }

      function fisherYatesShuffle(arr){
        for(let i = arr.length-1; i > 0;i--){
            let j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      function resultPasswords(arr){
        const words = document.getElementsByName('word');
        let word_num = 0;
        for(let i = 0; i < words.length; i++){
          if(words[i].checked) {
            word_num = words[i].value;
          }
        }
        const qtys  = document.getElementsByName('qty');
        let qty_num = 0;
        for(i = 0; i < qtys.length; i++){
          if(qtys[i].checked) {
            qty_num = qtys[i].value;
          }
        }

        let passwords = [];
        let j = 0;
        while(j < qty_num){
          let password = "";
          for(let k = 0; k < word_num; k++){
            password += arr[Math.floor(Math.random() * arr.length)];
          }
          if(!passwords.includes(password)){
            passwords.push(password);
            j++
          }
        }
        return passwords;
      }

      function resultDisplay(res){
        let tags = document.getElementsByClassName("heading tag rounded");
        for(let i = 0; i < tags.length ; i ++ ) {
          if(!tags[i].classList.contains("hide")){
            tags[i].classList.add("hide");
          }
        }

        for(let i = 0; i < res.length; i++){
          let disp = document.getElementsByClassName("hide")[0];
          disp.textContent = res[i];
          disp.classList.remove("hide");
        }
      }



      // リセットボタンクリック
      const reset_btn = document.getElementById('reset_btn');
      reset_btn.addEventListener('click', reset);
      // 作成ボタンクリック
      const create_btn = document.getElementById('create_btn');
      create_btn.addEventListener('click', create);
    </script>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

  </body>
</html>